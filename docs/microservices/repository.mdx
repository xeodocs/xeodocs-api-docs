---
title: Repository Service
description: Overview of the Repository microservice in XeoDocs' architecture, handling Git operations and file management for documentation projects.
template: doc
---

The Repository Service is a core microservice in XeoDocs. Developed in Golang, this service handles all Git interactions and file management for projects, called internally by the Worker Service to perform cloning, pulling, and change detection.

## Role in XeoDocs

In XeoDocs' microservices architecture, the Repository Service centralizes Git and file operations:

- **Repository Management**: Handles forking, cloning, pulling, and pushing of Git repositories within XeoDocs accounts.
- **Language Branch Creation**: Creates per-language branches in forked repositories to prepare for translation.
- **File Management**: Tracks translatable files, detects changes via hashes, manages static file access for publishing.
- **Publishing**: Commits and pushes static content to dedicated Git repositories for deployment.
- **Integration**: Called internally by Worker Service for Git ops; adheres to single responsibility, enabling reusability.

This service offloads Git and file handling from other services, improving separation of concerns.

## How It Works

1. **Internal Calls**: Receives requests from Worker Service via private endpoints (e.g., POST `/internal/setup-repo` for repository forking and cloning).
2. **Git Operations**: Uses go-git to fork, clone, pull, and push repositories to mounted volumes (e.g., `./repos:/repos`).
3. **File Processing**: Creates language-specific branches, detects translatable files, tracks changes via hashes, and manages static file publishing.
4. **Metadata Management**: Updates database with file info, handles cleanup on project removal.

Operations are invoked asynchronously by Worker, ensuring no direct user-facing APIs.

## Key Features

- **Git Integration**: Leverages `go-git` for all Git operations, supporting cloning, pulling, and change detection.
- **File Tracking**: Automatically detects and tracks translatable files with hash-based change detection.
- **Private Endpoints**: Exposes internal endpoints for Worker calls, secured with mTLS or API keys.
- **Mounted Volume Handling**: Operates on shared mounted volumes for repository storage and processing.
- **Asynchronous Processing**: Supports background processing for large repository operations.
- **Error Handling**: Implements retries and logging for failed Git operations.

## Repository Service Endpoints

Repository Service provides private APIs for Git and file operations, invoked internally by the Worker Service. Below is a list of its endpoints:

### Repository Management Endpoints
- **POST /internal/setup-repo**: Fork the source repository in XeoDocs GitHub/GitLab account, perform shallow clone, create language branches, and detect translatable files.
- **POST /internal/pull-and-detect**: Perform git pull on forked repository, detect changes in translatable files via hash comparisons.
- **GET /internal/repo-branches**: Access language-specific branches in the cloned repository on shared volume.
- **GET /internal/static-files**: Access generated static files from previous build for publishing.
- **POST /internal/publish-task**: Commit static files to dedicated static repository and perform git push.

These endpoints are private and secured with mTLS or API keys for service-to-service communication.

## Deployment

- **Docker**: Built via `Dockerfile.repository`; runs in `docker-compose.dev.yml`.
- **Volumes**: Mounts shared volume (e.g., `./repos:/repos`) for file system access.

The Repository Service streamlines Git and file operations in XeoDocs, supporting automated workflows for documentation translation and synchronization.

For related microservices, see [Project Service](/microservices/project) or [Scheduler Service](/microservices/scheduler). Begin with the [Installation Guide](/getting-started/installation).
